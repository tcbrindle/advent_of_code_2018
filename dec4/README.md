
Note: the use of a vector of variants in this solution triggers a bug in GCC/libstdc++ 8.2.
Use a recent version of Clang instead (but not AppleClang...)
